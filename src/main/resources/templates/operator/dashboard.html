<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>–ü–∞–Ω–µ–ª—å –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞</title>
    <link th:href="@{/css/style.css}" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="container">
        <div th:replace="fragments/header :: header"></div>
        
        <h2>–ü–∞–Ω–µ–ª—å –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞</h2>
        
        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
        <div class="statistics-section">
            <h3>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
            <div class="stats-grid">
                <div class="stat-card">
                    <h4>–í—Å–µ–≥–æ –∫–ª–∏–µ–Ω—Ç–æ–≤</h4>
                    <p class="stat-value" th:text="${statistics.totalClients}">0</p>
                </div>
                <div class="stat-card">
                    <h4>–ê–∫—Ç–∏–≤–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤</h4>
                    <p class="stat-value" th:text="${statistics.activeClients}">0</p>
                </div>
                <div class="stat-card">
                    <h4>–í—Å–µ–≥–æ –∑–∞–∫–∞–∑–æ–≤</h4>
                    <p class="stat-value" th:text="${statistics.totalOrders}">0</p>
                </div>
                <div class="stat-card">
                    <h4>–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞ (–º–∏–Ω)</h4>
                    <p class="stat-value" th:text="${statistics.avgCompletionTimeMinutes}">0</p>
                </div>
                <div class="stat-card">
                    <h4>–°—Ä–µ–¥–Ω—è—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–∫–∞–∑–∞</h4>
                    <p class="stat-value" th:text="${#numbers.formatDecimal(statistics.avgPrice, 1, 2)}">0</p>
                </div>
                <div class="stat-card">
                    <h4>–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞</h4>
                    <p class="stat-value" th:text="${#numbers.formatDecimal(statistics.totalRevenue, 1, 2)}">0</p>
                </div>
            </div>
            
            <div class="charts-container">
                <div class="chart-wrapper">
                    <h4>–ó–∞–∫–∞–∑—ã –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º</h4>
                    <canvas id="ordersByStatusChart"></canvas>
                </div>
            </div>
        </div>
        
        <div class="dashboard">
            <a th:href="@{/operator/clients}" class="dashboard-card">
                <h3>üë§ –ö–ª–∏–µ–Ω—Ç—ã</h3>
                <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞–º–∏</p>
            </a>
            
            <a th:href="@{/operator/orders}" class="dashboard-card">
                <h3>üìã –ó–∞–∫–∞–∑—ã</h3>
                <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞–º–∏</p>
            </a>
            
            <a th:href="@{/operator/tariffs}" class="dashboard-card">
                <h3>üí∞ –¢–∞—Ä–∏—Ñ—ã</h3>
                <p>–ü—Ä–æ—Å–º–æ—Ç—Ä —Ç–∞—Ä–∏—Ñ–æ–≤</p>
            </a>
            
            <a th:href="@{/operator/cars}" class="dashboard-card">
                <h3>üöô –ê–≤—Ç–æ–º–æ–±–∏–ª–∏</h3>
                <p>–ü—Ä–æ—Å–º–æ—Ç—Ä –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π</p>
            </a>
        </div>
    </div>
    
    <script th:inline="javascript">
        const ordersByStatus = /*[[${statistics.ordersByStatus}]]*/ {};
        const ctx = document.getElementById('ordersByStatusChart').getContext('2d');
        new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: Object.keys(ordersByStatus),
                datasets: [{
                    data: Object.values(ordersByStatus),
                    backgroundColor: ['#FFD700', '#FFA500', '#32CD32', '#FF6347', '#42AAFF'],
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true
            }
        });
    </script>
</body>
</html>