<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>–ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</title>
    <link th:href="@{/css/style.css}" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="container">
        <div th:replace="fragments/header :: header"></div>
        
        <h2>–ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h2>
        
        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
        <div class="statistics-section">
            <h3>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
            <div class="stats-grid">
                <div class="stat-card">
                    <h4>–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h4>
                    <p class="stat-value" th:text="${statistics.totalUsers}">0</p>
                </div>
                <div class="stat-card">
                    <h4>–í—Å–µ–≥–æ –≤–æ–¥–∏—Ç–µ–ª–µ–π</h4>
                    <p class="stat-value" th:text="${statistics.totalDrivers}">0</p>
                </div>
                <div class="stat-card">
                    <h4>–ê–∫—Ç–∏–≤–Ω—ã—Ö –≤–æ–¥–∏—Ç–µ–ª–µ–π</h4>
                    <p class="stat-value" th:text="${statistics.activeDrivers}">0</p>
                </div>
                <div class="stat-card">
                    <h4>–°—Ä–µ–¥–Ω–∏–π —Å—Ç–∞–∂ (–ª–µ—Ç)</h4>
                    <p class="stat-value" th:text="${statistics.avgExperience}">0</p>
                </div>
                <div class="stat-card">
                    <h4>–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞ (–º–∏–Ω)</h4>
                    <p class="stat-value" th:text="${statistics.avgCompletionTimeMinutes}">0</p>
                </div>
            </div>
            
            <div class="charts-container">
                <div class="chart-wrapper">
                    <h4>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ —Ä–æ–ª—è–º</h4>
                    <canvas id="usersByRoleChart"></canvas>
                </div>
            </div>
        </div>
        
        <div class="dashboard">
            <a th:href="@{/admin/users}" class="dashboard-card">
                <h3>üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h3>
                <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ —Å–∏—Å—Ç–µ–º—ã</p>
            </a>
            
            <a th:href="@{/admin/drivers}" class="dashboard-card">
                <h3>üöó –í–æ–¥–∏—Ç–µ–ª–∏</h3>
                <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–æ–¥–∏—Ç–µ–ª—è–º–∏</p>
            </a>
            
            <a th:href="@{/admin/cars}" class="dashboard-card">
                <h3>üöô –ê–≤—Ç–æ–º–æ–±–∏–ª–∏</h3>
                <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–≤—Ç–æ–º–æ–±–∏–ª—è–º–∏</p>
            </a>
            
            <a th:href="@{/admin/tariffs}" class="dashboard-card">
                <h3>üí∞ –¢–∞—Ä–∏—Ñ—ã</h3>
                <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–∞—Ä–∏—Ñ–∞–º–∏</p>
            </a>
        </div>
    </div>
    
    <script th:inline="javascript">
        const usersByRole = /*[[${statistics.usersByRole}]]*/ {};
        const ctx = document.getElementById('usersByRoleChart').getContext('2d');
        new Chart(ctx, {
            type: 'bar',
            data: {
                labels: Object.keys(usersByRole),
                datasets: [{
                    label: '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π',
                    data: Object.values(usersByRole),
                    backgroundColor: '#FFD700',
                    borderColor: '#FFA500',
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });
    </script>
</body>
</html>