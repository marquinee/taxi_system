<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <title>Профиль водителя</title>
    <link th:href="@{/css/style.css}" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="container">
        <div th:replace="fragments/header :: header"></div>
        
        <div class="nav-links">
            <a th:href="@{/driver/orders}" class="btn btn-secondary">Мои заказы</a>
        </div>
        
        <h2>Профиль водителя</h2>
        
        <!-- Персональная информация -->
        <div class="profile-section">
            <h3>Персональная информация</h3>
            <div class="profile-info">
                <div class="info-item">
                    <strong>ФИО:</strong>
                    <span th:text="${driver.fullName}">-</span>
                </div>
                <div class="info-item">
                    <strong>Номер лицензии:</strong>
                    <span th:text="${driver.licenseNumber}">-</span>
                </div>
                <div class="info-item">
                    <strong>Телефон:</strong>
                    <span th:text="${driver.phoneNumber}">-</span>
                </div>
                <div class="info-item">
                    <strong>Стаж (лет):</strong>
                    <span th:text="${driver.experienceYears}">-</span>
                </div>
                <div class="info-item">
                    <strong>Статус:</strong>
                    <span th:text="${driver.active ? 'Активен' : 'Неактивен'}">-</span>
                </div>
            </div>
        </div>
        
        <!-- Статистика -->
        <div class="statistics-section">
            <h3>Моя статистика</h3>
            <div class="stats-grid">
                <div class="stat-card">
                    <h4>Всего заказов</h4>
                    <p class="stat-value" th:text="${statistics.totalOrders}">0</p>
                </div>
                <div class="stat-card">
                    <h4>Завершено заказов</h4>
                    <p class="stat-value" th:text="${statistics.completedOrders}">0</p>
                </div>
                <div class="stat-card">
                    <h4>Среднее время выполнения заказа (мин)</h4>
                    <p class="stat-value" th:text="${statistics.avgCompletionTimeMinutes}">0</p>
                </div>
                <div class="stat-card">
                    <h4>Общий заработок</h4>
                    <p class="stat-value" th:text="${#numbers.formatDecimal(statistics.totalEarnings, 1, 2)}">0</p>
                </div>
                <div class="stat-card">
                    <h4>Средняя стоимость заказа</h4>
                    <p class="stat-value" th:text="${#numbers.formatDecimal(statistics.avgPrice, 1, 2)}">0</p>
                </div>
            </div>
            
            <div class="charts-container">
                <div class="chart-wrapper">
                    <h4>Заказы по статусам</h4>
                    <canvas id="ordersByStatusChart"></canvas>
                </div>
            </div>
        </div>
    </div>
    
    <script th:inline="javascript">
        const ordersByStatus = /*[[${statistics.ordersByStatus}]]*/ {};
        const ctx = document.getElementById('ordersByStatusChart').getContext('2d');
        new Chart(ctx, {
            type: 'pie',
            data: {
                labels: Object.keys(ordersByStatus),
                datasets: [{
                    data: Object.values(ordersByStatus),
                    backgroundColor: ['#FFD700', '#FFA500', '#32CD32', '#FF6347', '#808080'],
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true
            }
        });
    </script>
</body>
</html>